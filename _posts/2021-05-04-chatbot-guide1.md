---
layout: post
title:  "[카카오 오픈빌더로 챗봇 만들기] 카카오 오픈빌더 챗봇 가이드 - 1(Non Server Version)"
date:   2021-05-04 16:30:00
author: Yeonjun
categories: Chatbot
comments: true
---
해당 글은 백엔드 없이, 카카오 오픈빌더 만을 사용하여 기초적인 카카오톡 챗봇을 구성하는 방법을 소개합니다.

---
## 1. 카카오 오픈빌더 신청하기

Kakao i Open Builder를 시작하기에 앞서, [카카오i](https://i.kakao.com)에 접속하여 OBT 참여를 신청해야 합니다.
![1](/assets/2021-05-04/image1.png)
Form을 작성하여 신청합니다. 참고로 신청 사유를 명확히 쓰지 않으면 거절될 수 있다고 하니, 상세히 작성해야 합니다. (오픈빌더 OBT 심사는 영업일 기준 6일 정도 소요됩니다. 생각보다 오랜 시간이 소요되니, 신중히 작성하는 것을 추천합니다.)

카카오톡 채널 홈 URL에는, Kakao I OpenBuilder를 통해 제작된 챗봇과 연결한 카카오톡 채널의 주소를 입력해야 합니다.

만약, 개설한 카카오톡 채널이 없다면 [카카오톡채널 관리자센터](https://center-pf.kakao.com/) 에서 카카오톡 채널을 만듭니다.

---
## 2. 카카오 오픈빌더 시작하기
Kakao I OpenBuilder를 시작하기 전에 3가지 개념을 이해해야 합니다.

- **엔티티**

    엔티티(Entity)란 봇이 이해할 수 있는 용어를 체계적으로 정리한 데이터 사전입니다. 엔티티가 정의되어 있다면, 봇은 사용자 발화(챗봇의 경우에는 입력하는 텍스트 데이터)로부터 사용자의 의도에 맞는 동작 수행을 위한 주요 데이터를 추출할 수 있게 됩니다.

    예를 들어, 유저의 메시지에서 요일 정보를 추출하고 싶다면, 월요일, 화요일, 수요일, 목요일, 금요일, 토요일, 일요일 7개의 단어를 **요일**이라는 **엔티티**로 정의할 수 있습니다.

    엔티티는 나의 엔티티, 시스템 엔티티 두 가지로 나뉘어 집니다.

    ![2](/assets/2021-05-04/image2.png)

    '나의 엔티티'는 개발자가 직접 설정한 엔티티입니다.

    만약, 날짜라는 정보를 추출한다고 가정해보겠습니다. 사용자가 입력할 수 있는 날짜의 Case는 yyyy-mm-dd, yymmdd, mmdd, 오늘, 어제, 내일 ... 등 경우의 수가 굉장히 많습니다. 

    날짜, 시간, 지명과 같이 일반적, 공통적으로 통용되는 개념들에 대해서는 개발자가 일일이 입력할 필요가 없도록 미리 정의해둔 엔티티를 '시스템 엔티티'라 부릅니다. 시스템 엔티티 리스트는 [여기](https://i.kakao.com/docs/key-concepts-entity#%EC%8B%9C%EC%8A%A4%ED%85%9C-%EC%97%94%ED%8B%B0%ED%8B%B0)를 클릭하면 볼 수 있다.

- **시나리오**

    시나리오는 봇 안에서 사용자가 경험할 수 있는 서비스 단위입니다. 예를 들어, 금융과 관련된 서비스를 제공하는 봇에서 시나리오는 예금, 적금, 대출 등이 될 수 있습니다.

- **블록**

    블록은 사용자의 의도를 응대하는 가장 작은 단위이다. 1개의 블록은 1개의 의도를 표현합니다.

    ![3](/assets/2021-05-04/image3.png)

    이러한 동작을 정의하는 최소 단위가 **블록**입니다. 즉, 1개의 시나리오는 N개의 블록으로 이루어져 있습니다.

위 개념을 숙지했다면 [카카오i](https://i.kakao.com)에 접속하여 '+' 버튼을 클릭하여 새로운 봇을 만듭니다.

![4](/assets/2021-05-04/image4.png)

만든 봇을 클릭하고 들어가서, 시나리오를 생성해보겠습니다.

![5](/assets/2021-05-04/image5.png)

사용자가 처음 접속을 대비해 웰컴 시나리오를 만들고 그 안에 인사라는 블록을 추가했습니다.

그 다음, 사용자가 입력할 것 같은 발화를 정의해야 합니다.

![6](/assets/2021-05-04/image6.png)

만약 사용자가 (하이, 반갑습니다, 안녕, 안녕하세요) 를 입력한다면 인사 블록이 실행됩니다.

그 다음, 해당 발화에 대한 응답을 정의해주면 됩니다.

![7](/assets/2021-05-04/image7.png)

사용자가 안녕하세요 라고 입력하면, 위와 같은 응답이 출력됩니다.

우측 상단 봇테스트 버튼을 눌러 테스트를 진행할 수 있습니다.

![8](/assets/2021-05-04/image8.png)

테스트를 성공적으로 수행했습니다.

사용자의 발화에서 뽑아내는 정보를 **파라미터**라고 합니다. 사용자가 입력한 텍스트에서 데이터를 추출하기 위해 파라미터를 정의해야 합니다.

## 3.파라미터 정의하기
---
파라미터에는 일반 파라미터, 필수 파라미터 2가지 타입이 있습니다. 일반 파라미터는 필수로 입력 받지 않아도 되지만, 필수 파라미터는 사용자가 입력할 때 까지 되물어서 필수로 입력 받습니다.

회고록을 작성하는 챗봇을 예로 들겠습니다.

회고록 챗봇에는 '회고'라는 시나리오가 존재하게 됩니다.

'회고' 시나리오에는 언제의 회고록을 쓸 것인지 '날짜'라는 파라미터가 꼭 필요합니다.

'날짜' 필수 파라미터를 정의하기 위해 필수 파라미터를 추가해보겠습니다.

![9](/assets/2021-05-04/image9.png)

여기서 파라미터명은 추후 백엔드(스킬 서버)에서 필드명으로 쓰입니다.

엔티티는 시스템 엔티티에 존재하는 sys.date를 설정해주고, 값은 카카오 i 오픈빌더 도움말을 보면 '$'로 시작하고 파라미터 이름과 동일하게 사용해준다고 되어 있어서 **$date**로 설정했습니다.

필수 파라미터는 **되묻기 질문**을 필수로 설정해야 합니다. **되묻기 질문**은 사용자가 필수 파라미터를 제대로 입력할 때 까지 되묻는 것입니다.

![10](/assets/2021-05-04/image10.png)

이렇게 되묻기 질문을 설정해줍니다. 바로연결 응답 기능을 통해 사용자에게 편의성을 제공할 수 있습니다.

## 4. 사용자 엔티티 등록하기
---
회고록 챗봇에서는 어떤 종류의 회고를 쓸 것인지(ex) 개발, 일상, 도서)를 선택해야 합니다. 이러한 회고 타입은 시스템 엔티티에 정의되어 있지 않으니 개발자가 직접 설정해야 합니다.

우측 상단에 엔티티 → 나의 엔티티로 들어가서 사용자 엔티티를 설정해보겠습니다.

![11](/assets/2021-05-04/image11.png)

type이라는 엔티티를 만들고, type에 포함될 단어들을 설정했습니다.

## 5. 블록과 블록의 연결
---
회고 블록을 통해 날짜를 입력받고, 이에 대한 봇 응답을 설정해줍니다.

![12](/assets/2021-05-04/image12.png)

회고 블록과 다른 블록과의 연결을 위해, 사용자가 회고 블록 내에서 회고 타입을 선택할 수 있게 유도합니다. 봇 응답 하단에 있는 바로연결 버튼을 통해, 사용자는 회고 타입을 선택할 수 있습니다. 회고 타입이 선택되면, 회고록 작성 블록으로 이어지는 로직을 구성해보겠습니다.

 

회고 블록 하단에 있는 **바로연결** 버튼을 통해 사용자가 회고 타입을 선택할 수 있게 설정합니다. 사용자가 회고 타입을 선택하면 회고록 작성 블록으로 넘겨주는 로직으로 구성해보겠습니다.

![13](/assets/2021-05-04/image13.png)

바로연결 버튼을 설정하고 봇 테스트를 진행해보겠습니다.

![14](/assets/2021-05-04/image14.png)

이런 흐름으로 진행됩니다.  이제 회고록 작성 블록에서 회고 타입을 인식했을 때 로직을 구성해야 합니다.

'회고록 작성' 이라는 새로운 블록을 만들겠습니다.

![15](/assets/2021-05-04/image15.png)

회고록 작성이라는 새로운 블록을 만들고, 사용자 발화에 '개발'을 입력하면 오픈빌더에서 자체적으로 사용자 엔티티와 태깅할 수 있게 해줍니다. 밑줄을 드래그하면

![16](/assets/2021-05-04/image16.png)

type이라고 정의한 사용자 엔티티가 추천 엔티티에 나옵니다. 클릭하면 태깅과 동시에 일반 파라미터를 추가해 줍니다.

이제 사용자에게 회고 내용을 입력받아 보겠습니다.

## 5. 회고 내용 입력 받기
---
시스템 엔티티에 존재하는 @sys.text는 '유저가 입력한 문장 전체'를 태깅합니다. 사용자의 회고 내용을 sys.text 엔티티를 통해서 입력 받겠습니다.

sys.text를 사용하기 위해 시스템 엔티티를 설정해줘야 합니다.

![17](/assets/2021-05-04/image17.png)

비활성화 되어있는 sys.text를 활성화로 바꿉니다.

**회고 내용**을 필수 파라미터로 만들겠습니다.

![18](/assets/2021-05-04/image18.png)

content라는 회고 내용을 필수 파라미터로 만들었습니다.

필수 파라미터는 필수로 입력받기 위해서 되묻기 질문을 꼭 만들어야 한다.

![19](/assets/2021-05-04/image19.png)

되묻기 질문을 설정하고 마지막 마무리 봇 응답을 설정해주면 끝이다.

![20](/assets/2021-05-04/image20.png)